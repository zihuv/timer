# Timer - macOS Menu Bar Countdown Timer

ä¸€ä¸ªç®€æ´çš„ macOS èœå•æ å€’è®¡æ—¶åº”ç”¨ï¼Œå®Œå…¨ä½¿ç”¨åŸç”Ÿæ¡†æ¶æ„å»ºï¼ˆæ— å¤–éƒ¨ä¾èµ–ï¼‰ã€‚

## åŠŸèƒ½ç‰¹æ€§

- âœ¨ **èœå•æ é›†æˆ**ï¼šåº”ç”¨å›¾æ ‡å¸¸é©»èœå•æ ï¼Œä¸å ç”¨ Dock ç©ºé—´
- â± **å€’è®¡æ—¶åŠŸèƒ½**ï¼šè®¾ç½®åˆ†é’Ÿå’Œç§’æ•°ï¼Œå¼€å§‹å€’è®¡æ—¶
- â¸ **æš‚åœ/ç»§ç»­**ï¼šæ”¯æŒæš‚åœå’Œæ¢å¤å€’è®¡æ—¶ï¼Œä¸ä¼šä¸¢å¤±è¿›åº¦
- ğŸ”„ **æ™ºèƒ½é‡ç½®**ï¼šReset é‡æ–°å¼€å§‹ä¸Šæ¬¡è®¾ç½®çš„æ—¶é•¿ï¼Œè€Œéå›åˆ°ç©ºé—²çŠ¶æ€
- âŒ¨ **å¿«æ·é”®æ”¯æŒ**ï¼š
  - `ç©ºæ ¼é”®`ï¼šæš‚åœ/ç»§ç»­
  - `R é”®`ï¼šé‡ç½®å€’è®¡æ—¶
  - `âŒ˜,`ï¼šæ‰“å¼€è®¾ç½®
  - `âŒ˜Q`ï¼šé€€å‡ºåº”ç”¨

## å¿«é€Ÿå¼€å§‹

### ç¼–è¯‘åº”ç”¨

```bash
# å…‹éš†æˆ–ä¸‹è½½é¡¹ç›®åï¼Œè¿›å…¥é¡¹ç›®ç›®å½•
cd timer

# ç¼–è¯‘ Debug ç‰ˆæœ¬
./build.sh

# æˆ–ç¼–è¯‘ Release ç‰ˆæœ¬ï¼ˆä¼˜åŒ–åï¼Œä½“ç§¯æ›´å°ï¼‰
./build.sh Release
```

### è¿è¡Œåº”ç”¨

ç¼–è¯‘å®Œæˆåï¼Œæœ‰ä¸‰ç§è¿è¡Œæ–¹å¼ï¼š

```bash
# æ–¹æ³•1ï¼šä½¿ç”¨å¿«æ·è„šæœ¬
./build/run.sh

# æ–¹æ³•2ï¼šç›´æ¥æ‰“å¼€ .app æ–‡ä»¶
open build/timer.app

# æ–¹æ³•3ï¼šåŒå‡» build/timer.app æ–‡ä»¶ï¼ˆåœ¨ Finder ä¸­ï¼‰
```

## ä½¿ç”¨è¯´æ˜

1. **å¯åŠ¨åº”ç”¨**ï¼šè¿è¡Œåº”ç”¨åï¼Œèœå•æ ä¼šå‡ºç° â± å›¾æ ‡
2. **è®¾ç½®å€’è®¡æ—¶**ï¼š
   - ç‚¹å‡»èœå•æ å›¾æ ‡ â†’ é€‰æ‹© "Settings..."
   - è¾“å…¥åˆ†é’Ÿå’Œç§’æ•°ï¼ˆä¾‹å¦‚ 25:00ï¼‰
   - ç‚¹å‡» "Start" å¼€å§‹å€’è®¡æ—¶
3. **æš‚åœ/ç»§ç»­**ï¼š
   - ç‚¹å‡»èœå•æ å›¾æ ‡ â†’ é€‰æ‹© "Pause" æš‚åœ
   - é€‰æ‹© "Resume" ç»§ç»­
   - æˆ–ç›´æ¥æŒ‰ç©ºæ ¼é”®åˆ‡æ¢
4. **é‡ç½®å€’è®¡æ—¶**ï¼š
   - ç‚¹å‡»èœå•æ å›¾æ ‡ â†’ é€‰æ‹© "Reset"
   - æˆ–æŒ‰ `R` é”®
   - å€’è®¡æ—¶ä¼šé‡æ–°å¼€å§‹ä¸Šæ¬¡è®¾ç½®çš„æ—¶é•¿
5. **é€€å‡ºåº”ç”¨**ï¼šç‚¹å‡»èœå•æ å›¾æ ‡ â†’ é€‰æ‹© "Quit" æˆ–æŒ‰ `âŒ˜Q`

## é¡¹ç›®ç»“æ„

```
timer/
â”œâ”€â”€ timer/
â”‚   â””â”€â”€ timer/
â”‚       â”œâ”€â”€ timerApp.swift          # åº”ç”¨å…¥å£
â”‚       â”œâ”€â”€ AppDelegate.swift        # åº”ç”¨ç”Ÿå‘½å‘¨æœŸç®¡ç†
â”‚       â”œâ”€â”€ CountdownManager.swift   # å€’è®¡æ—¶æ ¸å¿ƒé€»è¾‘
â”‚       â”œâ”€â”€ CountdownState.swift     # çŠ¶æ€æ¨¡å‹
â”‚       â”œâ”€â”€ StatusBarManager.swift   # èœå•æ  UI ç®¡ç†
â”‚       â”œâ”€â”€ SettingsPopover.swift    # è®¾ç½®ç•Œé¢
â”‚       â”œâ”€â”€ Info.plist               # åº”ç”¨é…ç½®
â”‚       â””â”€â”€ timer.entitlements       # æƒé™é…ç½®
â”œâ”€â”€ timer.xcodeproj/                 # Xcode é¡¹ç›®æ–‡ä»¶
â”œâ”€â”€ create_project.sh                # é¡¹ç›®ç”Ÿæˆè„šæœ¬
â””â”€â”€ build.sh                         # æ„å»ºè„šæœ¬
```

## æŠ€æœ¯æ ˆ

- **è¯­è¨€**ï¼šSwift 5.0
- **UI æ¡†æ¶**ï¼šSwiftUI + AppKit
- **æ¶æ„**ï¼š
  - å•å‘æ•°æ®æµï¼ˆUnidirectional Data Flowï¼‰
  - ä¸å¯å˜çŠ¶æ€æ¨¡å¼ï¼ˆImmutable Stateï¼‰
  - Combine å“åº”å¼ç¼–ç¨‹
- **æœ€ä½ç³»ç»Ÿè¦æ±‚**ï¼šmacOS 12.0+

## å¼€å‘

### åœ¨ Xcode ä¸­å¼€å‘

```bash
# æ‰“å¼€é¡¹ç›®
open timer/timer.xcodeproj

# åœ¨ Xcode ä¸­æŒ‰ âŒ˜R è¿è¡Œ
```

### é‡æ–°ç”Ÿæˆ Xcode é¡¹ç›®

å¦‚æœä¿®æ”¹äº†é¡¹ç›®ç»“æ„ï¼Œè¿è¡Œä»¥ä¸‹å‘½ä»¤é‡æ–°ç”Ÿæˆ Xcode é¡¹ç›®æ–‡ä»¶ï¼š

```bash
cd timer
./create_project.sh
```

## æ¶æ„è®¾è®¡

### æ•°æ®æµ

```
ç”¨æˆ·è¾“å…¥ (SettingsPopover)
    â†’ CountdownManager.startCountdown()
    â†’ æ›´æ–° state.endTime
    â†’ @Published è§¦å‘æ›´æ–°
    â†’ StatusBarManager é€šè¿‡ Combine æ¥æ”¶å˜åŒ–
    â†’ æ›´æ–° NSStatusItem æ ‡é¢˜
```

### çŠ¶æ€ç®¡ç†

åº”ç”¨ä½¿ç”¨ä¸å¯å˜çŠ¶æ€æ¨¡å¼ï¼Œæ¯æ¬¡çŠ¶æ€å˜æ›´éƒ½åˆ›å»ºæ–°çš„ `CountdownState` å¯¹è±¡ï¼š

```swift
enum CountdownStatus {
    case idle        // æœªè®¾ç½®å€’è®¡æ—¶
    case running     // è¿è¡Œä¸­
    case paused      // æš‚åœçŠ¶æ€
    case finished    // å·²å®Œæˆ
}

struct CountdownState {
    var endTime: Date?
    var lastDuration: TimeInterval?
    var isPaused: Bool
    var pausedAt: Date?
    // ...
}
```

## è®¸å¯è¯

æœ¬é¡¹ç›®ä»…ä¾›å­¦ä¹ å’Œä¸ªäººä½¿ç”¨ã€‚

## ä½œè€…

Created with â¤ï¸ using Claude Code
